@model PeopleEvents.Models.Person

@{
	ViewBag.Title = Model.Name;
	Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="row">

	<div class="col-md-6">
		<h4>Person Details</h4>
		<dl class="dl-horizontal">
			<dt>
				@Html.DisplayNameFor(model => model.Name)
			</dt>

			<dd>
				@Html.DisplayFor(model => model.Name)
			</dd>

			<dt>
				@Html.DisplayNameFor(model => model.DateOfBirth)
			</dt>

			<dd>
				@{ string dateOfBirthDisplay = Model.DateOfBirth.ToString("dd MMMM yyyy"); }
				@Html.DisplayFor(model => dateOfBirthDisplay)
			</dd>

			<dt>
				@Html.DisplayNameFor(model => model.Gender)
			</dt>

			<dd>
				@Html.DisplayFor(model => model.Gender)
			</dd>

		</dl>
	</div>
	<div id="events" class="col-md-6">
		@Html.Action("EventView", Model.ID)
	</div>
</div>
<div class="row">
	<p>
		<a href="#" onclick="editPerson(@Model.ID)">Edit</a> | 
		@Html.ActionLink("Back to List", "Index", "Home")
	</p>
</div>

<!-- Modal for editing the person -->
<div id="modalArea" class="modal fade">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<a href="#" class="close" data-dismiss="modal">&times;</a>
				<h3 id="modalHeader">Edit Person</h3>
			</div>
			<div id="modalBody" class="modal-body">
				<p>Loading...</p>
			</div>
			<div class="modal-footer">
				<button class="btn btn-primary" data-dismiss="modal" aria-hidden="true">Close</button>
			</div>
		</div>
	</div>
</div>

<!-- Script to handle person edit modal -->
<script type="text/javascript">
	var editPerson = function (personID) {
		var url = "/Person/Edit/" + personID;

		$("#modalBody").load(url, function () {
			$("#modalArea").modal("show");
		})
	}
</script>

<!-- Script to auto-refresh the events partial view every five seconds -->
<script type="text/javascript">
	$(function () {
		setInterval(function () { $('#events').load('/Person/EventView/' + @Model.ID); }, 5000);
	})
</script>
